# Default values for mapserver.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

nameOverride: ''
fullnameOverride: ''

imagePullSecrets: []

image:
  pullPolicy: IfNotPresent

print:
  serviceName: print
  replicaCount: 1
  terminationGracePeriodSeconds: 120
  image:
    repository: camptocamp/mapfish_print
    tag: latest
    hash:
  env:
    LOG_LEVEL:
      value: INFO
    PRINT_YAML_MAX_ALIASES:
      value: '200'
    DOLLAR:
      value: $
    DISABLE_MUTUALIZED_PRINT:
      value: ''
    DISABLE_LOCAL_PRINT:
      value: '#'
  maxContentLength: '6291456'
  maxNumberOfRunningPrintJobs: 2
  cacheDurationSeconds: 60
  dbSchema: public
  # resources are automatically computed for this service (in function of maxMemory)
  catalinaOpts: ''
  # nodeSelector: {}
  # tolerations: []
  # affinity: {}
  maxMemory: 3072
  resources: {}

config:
  serviceName: config
  replicaCount: 1
  image:
    repository: camptocamp/shared_config_manager
    tag: latest
    sha:
  env:
    SCM_ENV_PREFIXES:
      value: MUTUALIZED_:DOLLAR:DISABLE_
    DOLLAR:
      value: $
    DISABLE_MUTUALIZED_PRINT:
      value: ''
    DISABLE_LOCAL_PRINT:
      value: '#'
    LOG_LEVEL:
      value: INFO
  resources: {}
  slave:
    env:
      LOG_LEVEL:
        value: INFO
      TAG_FILTER:
        value: master
      C2C_SECRET:
        value: secret
      C2C_REQUESTS_DEFAULT_TIMEOUT:
        value: '30'
      SENTRY_TAG_SERVICE:
        value: config-slave
      LOG_TYPE:
        value: json
      MASTER_CONFIG:
        type: configMap
        name: scm-master-config
        key: data
      API_BASE_URL:
        type: configMap
        name: env
        key: API_BASE_URL
      C2C_REDIS_SENTINELS:
        type: configMap
        name: env
        key: REDIS_SENTINELS
      C2C_REDIS_DB:
        type: configMap
        name: env
        key: REDIS_DB
      C2C_REDIS_SERVICENAME:
        type: configMap
        name: env
        key: REDIS_SERVICENAME
      C2C_REDIS_TIMEOUT:
        type: configMap
        name: env
        key: REDIS_TIMEOUT
      C2C_BROADCAST_PREFIX:
        type: configMap
        name: env
        key: C2C_BROADCAST_PREFIX
      SENTRY_URL:
        type: configMap
        name: env
        key: SENTRY_URL
      SENTRY_CLIENT_ENVIRONMENT:
        type: configMap
        name: env
        key: RELEASE_NAME
      SENTRY_CLIENT_RELEASE:
        type: configMap
        name: env
        key: CONFIG_IMAGE_TAG
      MUTUALIZED_PRINT_URL:
        type: configMap
        name: env
        key: MUTUALIZED_PRINT_URL
    resources: {}
  # nodeSelector: {}
  # tolerations: []
  # affinity: {}

logs:
  serviceName: logs
  replicaCount: 1
  image:
    repository: camptocamp/mapfish-print-logs
    tag: latest
    sha:
  env:
    DB_SCHEMA:
      value: print
    C2C_SECRET:
      value: secret
    SOURCES_KEY:
      value: lll
    SENTRY_TAG_SERVICE:
      value: logs
    LOG_TYPE:
      value: json
    SHARED_CONFIG_MASTER:
      value: /master_config/master/shared_config_manager.yaml
    ES_URL:
      value: https://elasticsearch.logs.camptocamp.com/
    ES_INDEXES:
      value: openshift-ch-1-gs-mutualized-print-*
    SQLALCHEMY_URL:
      type: configMap
      name: env
      kex: SQLALCHEMY_URL
    C2C_REDIS_SENTINELS:
      type: configMap
      name: env
      key: REDIS_SENTINELS
    C2C_REDIS_DB:
      type: configMap
      name: env
      key: REDIS_DB
    C2C_REDIS_SERVICENAME:
      type: configMap
      name: env
      key: REDIS_SERVICENAME
    C2C_REDIS_TIMEOUT:
      type: configMap
      name: env
      key: REDIS_TIMEOUT
    C2C_BROADCAST_PREFIX:
      type: configMap
      name: env
      key: LOGS_BROADCAST_PREFIX
    SENTRY_URL:
      type: configMap
      name: env
      key: SENTRY_URL
    SENTRY_CLIENT_ENVIRONMENT:
      type: configMap
      name: env
      key: RELEASE_NAME
    SENTRY_CLIENT_RELEASE:
      type: configMap
      name: env
      key: LOGS_IMAGE_TAG
    SCM_URL:
      type: configMap
      name: env
      key: SCM_URL
    SCM_URL_EXTERNAL:
      type: configMap
      name: env
      key: SCM_URL_EXTERNAL
    ES_FILTERS:
      type: configMap
      name: env
      key: ES_FILTERS
    ES_AUTH:
      type: configMap
      name: env
      key: ES_AUTH
    PGPORT:
      type: secret
      name: postgresql-secret
      key: port
    PGHOST:
      type: secret
      name: postgresql-secret
      key: hostnameSlave
    PGHOST_MASTER:
      type: secret
      name: postgresql-secret
      key: hostname
    PGDATABASE:
      type: secret
      name: postgresql-secret
      key: database
    PGUSER:
      type: secret
      name: postgresql-secret
      key: username
    PGPASSWORD:
      type: secret
      name: postgresql-secret
      key: password
    DB_HOST:
      type: secret
      name: postgresql-secret
      key: hostnameSlave
    DB_DATABASE:
      type: secret
      name: postgresql-secret
      key: database
    DB_USERNAME:
      type: secret
      name: postgresql-secret
      key: username
    DB_PASSWORD:
      type: secret
      name: postgresql-secret
      key: password
  resources: {}
  service:
    type: ClusterIP
    port: 8080
  elasticsearch:
    auth:
      user: ''
      password: ''
  # nodeSelector: {}
  # tolerations: []
  # affinity: {}

dbstats:
  image:
    repository: camptocamp/c2cwsgiutils
    tag: latest
    sha:
  env:
    LOG_LEVEL:
      value: WARNING
    LOG_TYPE:
      value: json
    C2C_REQUESTS_DEFAULT_TIMEOUT:
      value: '30'
    C2CWSGIUTILS_STATS_DB_TRYNUMBER:
      value: '10'
    C2CWSGIUTILS_STATS_DB_SLEEP:
      value: '30'
    SENTRY_TAG_SERVICE:
      value: dbstats
    STATSD_USE_TAGS:
      value: '1'
    SENTRY_URL:
      type: configMap
      name: env
      key: SENTRY_URL
    SENTRY_CLIENT_ENVIRONMENT:
      type: configMap
      name: env
      key: RELEASE_NAME
    SENTRY_CLIENT_RELEASE:
      type: configMap
      name: env
      key: DBSTATS_IMAGE_TAG
    STATSD_TAG_CHART:
      type: configMap
      name: env
      key: CHART_NAME
    STATSD_TAG_RELEASE:
      type: configMap
      name: env
      key: RELEASE_NAME
    STATSD_TAG_NAMESPACE:
      type: configMap
      name: env
      key: RELEASE_NAMESPACE
    PGHOST:
      type: secret
      name: postgresql-secret
      key: hostnameSlave
    PGDATABASE:
      type: secret
      name: postgresql-secret
      key: database
    PGUSER:
      type: secret
      name: postgresql-secret
      key: username
    PGPASSWORD:
      type: secret
      name: postgresql-secret
      key: password
  resources: {}
  prometheus: http://prometheus-pushgateway.gs-metrics.svc:9091/

statsd:
  enabled: true
  url: monitoring-statsd:9125

postgresql:
  statementTimeout: 30000

redis:
  host: rfs-redis-redisfailover
  port: 26379
  db: 0
  servicename: mymaster
  timeout: 30

sentry:
  hostname: o330647.ingest.sentry.io
  key: ''
  secret: ''
  project: 42

serviceAccount:
  # Specifies whether a service account should be created
  create: false
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: default

podSecurityContext:
  {}
  # fsGroup: 2000

securityContext:
  runAsNonRoot: true
  runAsUser: 33 # www-data
  readOnlyRootFilesystem: true
  # capabilities:
  #   drop:
  #   - ALL

ingress:
  enabled: false
  annotations:
    {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: chart-example.local
      paths: []

  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

nodeSelector: {}

tolerations: []

affinity: {}
